read_data       ${fname}
read_data       P8-1-P1.txt
  orthogonal box = (0.016 0.005 0.0175) to (14.927 14.916 14.9285)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  192 atoms
change_box 	all triclinic
  triclinic box = (0.016 0.005 0.0175) to (14.927 14.916 14.9285) with tilt (0 0 0)

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 5.94 | 5.94 | 5.94 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
       0            0    -1397.632    33.704599    79.298396    79.298396   -57.482995 -0.007318592  0.086267247 -0.086267246       14.911       14.911       14.911    3315.2807 
     297            0   -1397.6332 9.0576194e-10 1.0784376e-08 3.7490905e-10 -8.4419989e-09 4.0044664e-10 -1.3116452e-09 7.8630037e-10    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.297455 on 1 procs for 297 steps with 192 atoms

97.8% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63202871     -1397.63316683     -1397.63316683
  Force two-norm initial, final = 0.529876 8.96641e-11
  Force max component initial, final = 0.164087 2.23163e-11
  Final line search alpha, max atom move = 1 2.23163e-11
  Iterations, force evaluations = 297 588

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28147    | 0.28147    | 0.28147    |   0.0 | 94.63
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0030761  | 0.0030761  | 0.0030761  |   0.0 |  1.03
Output  | 3.7193e-05 | 3.7193e-05 | 3.7193e-05 |   0.0 |  0.01
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.01287    |            |       |  4.33

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

#dump rel all xyz 10 relaxed-*.xyz
#dump 3 all xyz 10 relaxed.xyz
#dump 3 all atom 10 dump.atom

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 1.07843756438495e-08
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 3.74909045227253e-10
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal -8.44199886728659e-09
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal 7.86300367322641e-10
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal -1.31164515422379e-09
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal 4.00446639034948e-10

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.9113119190729
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.911311919073
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 14.9113119190741

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-1.07843756438495e-08)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-1.07843756438495e-08)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-3.74909045227253e-10)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-3.74909045227253e-10)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--8.44199886728659e-09)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--8.44199886728659e-09)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-7.86300367322641e-10)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-7.86300367322641e-10)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--1.31164515422379e-09)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--1.31164515422379e-09)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-4.00446639034948e-10)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-4.00446639034948e-10)/(v_delta/v_len0)*0.0001

displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 ${atomjiggle} ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 ${atomjiggle} 87287 units box
displace_atoms all random 1e-05 1e-05 1e-05 87287 units box

# Write restart
unfix 3
write_restart restart.equil

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 14.9113119190729
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.9113119190729
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.000149113119190729 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.000149113119190729 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.000149113119190729 xy delta -0 xz delta -0 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.927 14.9162 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.927 14.9162 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.927 14.9162 14.9287) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332     13.43392     27.78597    7.2823256    5.2334639  -0.19836908  -0.07636886    0.5292431    14.911163    14.911312    14.911312    3315.4556 
     431            0   -1397.6332    11.534687    14.728781    9.9376396    9.9376396 -2.3668436e-08 6.1110571e-09 3.6463757e-08    14.911163    14.911312    14.911312    3315.4556 
Loop time of 0.136264 on 1 procs for 134 steps with 192 atoms

93.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316608     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.00989307 8.12309e-11
  Force max component initial, final = 0.00140025 1.10584e-11
  Final line search alpha, max atom move = 1 1.10584e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13288    | 0.13288    | 0.13288    |   0.0 | 97.52
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0016747  | 0.0016747  | 0.0016747  |   0.0 |  1.23
Output  | 6.7711e-05 | 6.7711e-05 | 6.7711e-05 |   0.0 |  0.05
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.00164    |            |       |  1.20

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 14.7287807572427
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 9.93763963226964
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 9.93763960119834
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.3668435705003e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 6.11105708761223e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.64637565623813e-08

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 147.287807464583
variable C2neg equal ${d2}
variable C2neg equal 99.3763963189473
variable C3neg equal ${d3}
variable C3neg equal 99.3763960964034
variable C4neg equal ${d4}
variable C4neg equal 3.56774561950587e-07
variable C5neg equal ${d5}
variable C5neg equal 7.42270224183602e-08
variable C6neg equal ${d6}
variable C6neg equal -2.4068882344038e-07

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.9113119190729
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.000149113119190729 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.000149113119190729 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.000149113119190729 xy delta 0 xz delta 0 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9273 14.9162 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9273 14.9162 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9273 14.9162 14.9287) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332   -13.404007   -26.419171   -5.8720061   -7.9208448  -0.19830034 -0.076368362   0.52918394    14.911461    14.911312    14.911312     3315.522 
     431            0   -1397.6332   -11.534497   -14.729157   -9.9371664   -9.9371665 -1.2630682e-08 -3.3224292e-09 2.7428389e-08    14.911461    14.911312    14.911312     3315.522 
Loop time of 0.127122 on 1 procs for 134 steps with 192 atoms

95.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
         -1397.6331661     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.00925881 8.09026e-11
  Force max component initial, final = 0.00116551 1.07421e-11
  Final line search alpha, max atom move = 1 1.07421e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12423    | 0.12423    | 0.12423    |   0.0 | 97.73
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014484  | 0.0014484  | 0.0014484  |   0.0 |  1.14
Output  | 5.5075e-05 | 5.5075e-05 | 5.5075e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001385   |            |       |  1.09

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316667344
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -11.5344965756283
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -14.7291568488761
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -9.93716642111267
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -9.93716645689617
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.2630681749817e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -3.32242919025207e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2.74283890753454e-08

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 147.291568596605
variable C2pos equal ${d2}
variable C2pos equal 99.3716642148758
variable C3pos equal ${d3}
variable C3pos equal 99.3716644845417
variable C4pos equal ${d4}
variable C4pos equal -2.66420887080228e-07
variable C5pos equal ${d5}
variable C5pos equal 2.01078403602828e-08
variable C6pos equal ${d6}
variable C6pos equal 1.3031128388852e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(147.287807464583+${C1pos})
variable C11 equal 0.5*(147.287807464583+147.291568596605)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(99.3763963189473+${C2pos})
variable C21 equal 0.5*(99.3763963189473+99.3716642148758)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(99.3763960964034+${C3pos})
variable C31 equal 0.5*(99.3763960964034+99.3716644845417)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(3.56774561950587e-07+${C4pos})
variable C41 equal 0.5*(3.56774561950587e-07+-2.66420887080228e-07)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(7.42270224183602e-08+${C5pos})
variable C51 equal 0.5*(7.42270224183602e-08+2.01078403602828e-08)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-2.4068882344038e-07+${C6pos})
variable C61 equal 0.5*(-2.4068882344038e-07+1.3031128388852e-07)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.911311919073
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.911311919073
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.00014911311919073 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.00014911311919073 yz delta -0 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.916 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.916 14.9287) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332    13.433915    7.2600038    27.808298    5.2334432  -0.19831954 -0.076378605   0.52919371    14.911312    14.911163    14.911312    3315.4556 
     431            0   -1397.6332    11.534687    9.9376396    14.728781    9.9376396 -1.6940822e-08 1.8610439e-09 3.5313051e-08    14.911312    14.911163    14.911312    3315.4556 
Loop time of 0.135691 on 1 procs for 134 steps with 192 atoms

92.7% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316608     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.00981506 7.96134e-11
  Force max component initial, final = 0.00134678 1.21163e-11
  Final line search alpha, max atom move = 1 1.21163e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13263    | 0.13263    | 0.13263    |   0.0 | 97.74
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014665  | 0.0014665  | 0.0014665  |   0.0 |  1.08
Output  | 6.5327e-05 | 6.5327e-05 | 6.5327e-05 |   0.0 |  0.05
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001528   |            |       |  1.13

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9.93763963357679
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 14.7287807563268
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 9.93763960045613
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.69408219727528e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1.86104393397153e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.53130511225802e-08

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 99.3763962279242
variable C2neg equal ${d2}
variable C2neg equal 147.287807559519
variable C3neg equal ${d3}
variable C3neg equal 99.3763960889813
variable C4neg equal ${d4}
variable C4neg equal 3.45267507552576e-07
variable C5neg equal ${d5}
variable C5neg equal 3.17268908819532e-08
variable C6neg equal ${d6}
variable C6neg equal -1.73412686117877e-07

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.911311919073
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.00014911311919073 yz delta ${deltayz} remap units box
change_box all y delta 0 0.00014911311919073 yz delta 0 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9163 14.9287) with tilt (0 0 0)
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9163 14.9287) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332   -13.404003   -5.8943275   -26.396857   -7.9208241  -0.19834987 -0.076358619   0.52923332    14.911312    14.911461    14.911312     3315.522 
     431            0   -1397.6332   -11.534497   -9.9371664   -14.729157   -9.9371665 -1.8100608e-08 2.9520305e-09 2.2482729e-08    14.911312    14.911461    14.911312     3315.522 
Loop time of 0.139238 on 1 procs for 134 steps with 192 atoms

92.4% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316611     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.00934145 8.25238e-11
  Force max component initial, final = 0.0013321 1.15725e-11
  Final line search alpha, max atom move = 1 1.15725e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13575    | 0.13575    | 0.13575    |   0.0 | 97.50
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0017202  | 0.0017202  | 0.0017202  |   0.0 |  1.24
Output  | 4.7684e-05 | 4.7684e-05 | 4.7684e-05 |   0.0 |  0.03
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001715   |            |       |  1.23

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316667344
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -11.5344965755832
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -9.93716641864638
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -14.7291568497788
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -9.93716645832433
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.81006079628602e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2.95203048321325e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2.24827293983948e-08

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 99.3716642943076
variable C2pos equal ${d2}
variable C2pos equal 147.291568501537
variable C3pos equal ${d3}
variable C3pos equal 99.3716644988233
variable C4pos equal ${d4}
variable C4pos equal -2.16964290310722e-07
variable C5pos equal ${d5}
variable C5pos equal -4.26367563743704e-08
variable C6pos equal ${d6}
variable C6pos equal 1.85010546018952e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(99.3763962279242+${C1pos})
variable C12 equal 0.5*(99.3763962279242+99.3716642943076)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(147.287807559519+${C2pos})
variable C22 equal 0.5*(147.287807559519+147.291568501537)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(99.3763960889813+${C3pos})
variable C32 equal 0.5*(99.3763960889813+99.3716644988233)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(3.45267507552576e-07+${C4pos})
variable C42 equal 0.5*(3.45267507552576e-07+-2.16964290310722e-07)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(3.17268908819532e-08+${C5pos})
variable C52 equal 0.5*(3.17268908819532e-08+-4.26367563743704e-08)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-1.73412686117877e-07+${C6pos})
variable C62 equal 0.5*(-1.73412686117877e-07+1.85010546018952e-07)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 14.9113119190741
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.9113119190741
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9285) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332    13.433821    7.2600128    7.2823139    25.759136  -0.19833069 -0.076374918   0.52927489    14.911312    14.911312    14.911163    3315.4556 
     431            0   -1397.6332    11.534687    9.9376396    9.9376396    14.728781 -2.2476526e-08 -3.242663e-09 4.0748106e-08    14.911312    14.911312    14.911163    3315.4556 
Loop time of 0.130128 on 1 procs for 134 steps with 192 atoms

96.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316612     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.00901449 7.86926e-11
  Force max component initial, final = 0.00120823 1.32246e-11
  Final line search alpha, max atom move = 1 1.32246e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12718    | 0.12718    | 0.12718    |   0.0 | 97.73
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014579  | 0.0014579  | 0.0014579  |   0.0 |  1.12
Output  | 4.2677e-05 | 4.2677e-05 | 4.2677e-05 |   0.0 |  0.03
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001448   |            |       |  1.11

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9.93763963291549
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 9.93763963264176
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 14.7287807247882
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.24765263404645e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -3.2426630353217e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 4.07481063199698e-08

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 99.3763962213112
variable C2neg equal ${d2}
variable C2neg equal 99.3763963226685
variable C3neg equal ${d3}
variable C3neg equal 147.287807332302
variable C4neg equal ${d4}
variable C4neg equal 3.99618059526472e-07
variable C5neg equal ${d5}
variable C5neg equal -1.93101788109791e-08
variable C6neg equal ${d6}
variable C6neg equal -2.28769729794995e-07

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.9113119190741
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9288) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332   -13.403908   -5.8943365   -5.8719944   -28.445394  -0.19833873 -0.076362305   0.52915215    14.911312    14.911312    14.911461     3315.522 
     431            0   -1397.6332   -11.534497   -9.9371664   -9.9371664   -14.729157 -1.4806721e-08 -8.4766796e-10 3.5613643e-08    14.911312    14.911312    14.911461     3315.522 
Loop time of 0.136801 on 1 procs for 134 steps with 192 atoms

94.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316606     -1397.63316667     -1397.63316667
  Force two-norm initial, final = 0.010116 9.19404e-11
  Force max component initial, final = 0.0015241 1.32416e-11
  Final line search alpha, max atom move = 1 1.32416e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13333    | 0.13333    | 0.13333    |   0.0 | 97.46
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0017517  | 0.0017517  | 0.0017517  |   0.0 |  1.28
Output  | 5.1022e-05 | 5.1022e-05 | 5.1022e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001669   |            |       |  1.22

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316667344
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -11.5344965747956
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -9.93716642972948
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -9.93716642660277
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -14.7291568680547
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1.48067205037994e-08
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -8.47667956432999e-10
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.56136425422486e-08

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 99.3716644051386
variable C2pos equal ${d2}
variable C2pos equal 99.3716642697768
variable C3pos equal ${d3}
variable C3pos equal 147.291568596127
variable C4pos equal ${d4}
variable C4pos equal -3.4827342174926e-07
variable C5pos equal ${d5}
variable C5pos equal -4.63977197790791e-09
variable C6pos equal ${d6}
variable C6pos equal 1.52071671428343e-07

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(99.3763962213112+${C1pos})
variable C13 equal 0.5*(99.3763962213112+99.3716644051386)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(99.3763963226685+${C2pos})
variable C23 equal 0.5*(99.3763963226685+99.3716642697768)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(147.287807332302+${C3pos})
variable C33 equal 0.5*(147.287807332302+147.291568596127)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(3.99618059526472e-07+${C4pos})
variable C43 equal 0.5*(3.99618059526472e-07+-3.4827342174926e-07)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-1.93101788109791e-08+${C5pos})
variable C53 equal 0.5*(-1.93101788109791e-08+-4.63977197790791e-09)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-2.28769729794995e-07+${C6pos})
variable C63 equal 0.5*(-2.28769729794995e-07+1.52071671428343e-07)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 14.9113119190741
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.9113119190741
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 -0.000149113)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332  0.014624029    0.6826485   0.70490609   -1.3436825  -0.19834322  -0.07637546    14.152248    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.505996e-05 1.5994992e-05 -0.00011319753 2.2022658e-05 -2.6123456e-09 5.6281423e-09    7.9663216    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.131786 on 1 procs for 134 steps with 192 atoms

95.2% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316622     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.00955827 9.72845e-11
  Force max component initial, final = 0.00118562 1.07008e-11
  Final line search alpha, max atom move = 1 1.07008e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12883    | 0.12883    | 0.12883    |   0.0 | 97.76
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014696  | 0.0014696  | 0.0014696  |   0.0 |  1.12
Output  | 5.5075e-05 | 5.5075e-05 | 5.5075e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001432   |            |       |  1.09

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1.59949922468097e-05
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.000113197530354293
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2.20226584651021e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -2.61234562538715e-09
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 5.62814231261015e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 7.96632156583482

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.000159842078711659
variable C2neg equal ${d2}
variable C2neg equal -0.00113197905263338
variable C3neg equal ${d3}
variable C3neg equal 0.000220311004639694
variable C4neg equal ${d4}
variable C4neg equal 79.6632156504852
variable C5neg equal ${d5}
variable C5neg equal 6.93978746683394e-08
variable C6neg equal ${d6}
variable C6neg equal -3.0127922644221e-08

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.9113119190741
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0.000149113)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332  0.014587186   0.68259993   0.70496687   -1.3438052  -0.19832619 -0.076361764   -13.093821    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.5061708e-05 1.5994352e-05 -0.0001131996 2.2020123e-05 8.2085123e-10 2.8044141e-09   -7.9663216    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.130672 on 1 procs for 134 steps with 192 atoms

96.1% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316624     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.00937626 8.66132e-11
  Force max component initial, final = 0.0012806 1.03894e-11
  Final line search alpha, max atom move = 1 1.03894e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12776    | 0.12776    | 0.12776    |   0.0 | 97.77
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014617  | 0.0014617  | 0.0014617  |   0.0 |  1.12
Output  | 4.7684e-05 | 4.7684e-05 | 4.7684e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001404   |            |       |  1.07

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316674342
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.50617080793109e-05
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1.59943523047531e-05
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -0.000113199599972399
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2.20201234297134e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 8.20851229533052e-10
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2.80441408301645e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -7.96632157153421

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.000159835679291093
variable C2pos equal ${d2}
variable C2pos equal 0.00113199974881444
variable C3pos equal ${d3}
variable C3pos equal -0.000220285654285807
variable C4pos equal ${d4}
variable C4pos equal 79.6632157232051
variable C5pos equal ${d5}
variable C5pos equal -4.11605923724024e-08
variable C6pos equal ${d6}
variable C6pos equal -4.20404590498104e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(0.000159842078711659+${C1pos})
variable C14 equal 0.5*(0.000159842078711659+-0.000159835679291093)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-0.00113197905263338+${C2pos})
variable C24 equal 0.5*(-0.00113197905263338+0.00113199974881444)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(0.000220311004639694+${C3pos})
variable C34 equal 0.5*(0.000220311004639694+-0.000220285654285807)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(79.6632156504852+${C4pos})
variable C44 equal 0.5*(79.6632156504852+79.6632157232051)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(6.93978746683394e-08+${C5pos})
variable C54 equal 0.5*(6.93978746683394e-08+-4.11605923724024e-08)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-3.0127922644221e-08+${C6pos})
variable C64 equal 0.5*(-3.0127922644221e-08+-4.20404590498104e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 14.9113119190741
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.9113119190741
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 -0.000149113 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332  0.014600855   0.68261615   0.70493659   -1.3437502  -0.19832529     13.54668   0.52920667    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.5061476e-05 -0.00011325707 1.6057461e-05 2.2015178e-05 2.2318569e-10    7.9663216 3.5276216e-09    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.145056 on 1 procs for 134 steps with 192 atoms

91.9% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316623     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.00945521 8.94635e-11
  Force max component initial, final = 0.00129375 1.11816e-11
  Final line search alpha, max atom move = 1 1.11816e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.14119    | 0.14119    | 0.14119    |   0.0 | 97.33
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0018322  | 0.0018322  | 0.0018322  |   0.0 |  1.26
Output  | 4.8637e-05 | 4.8637e-05 | 4.8637e-05 |   0.0 |  0.03
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001987   |            |       |  1.37

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.000113257067498727
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1.60574606348894e-05
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2.20151776132791e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2.23185693781536e-10
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 7.96632157363258
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.52762157152008e-09

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.00113267851874371
variable C2neg equal ${d2}
variable C2neg equal 0.000160570857258442
variable C3neg equal ${d3}
variable C3neg equal 0.000220236196121464
variable C4neg equal ${d4}
variable C4neg equal 2.74132120419744e-08
variable C5neg equal ${d5}
variable C5neg equal 79.6632157494423
variable C6neg equal ${d6}
variable C6neg equal -1.77260945253412e-09

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.9113119190741
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.000149113119190741 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0.000149113 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332   0.01461036   0.68261359   0.70495505   -1.3437376  -0.19834412   -13.699417   0.52922037    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.5059908e-05 -0.00011326193 1.6059037e-05 2.2023174e-05 7.7256586e-11   -7.9663216 3.367958e-09    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.128843 on 1 procs for 134 steps with 192 atoms

95.7% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316623     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.00948018 9.7684e-11
  Force max component initial, final = 0.00121076 1.10321e-11
  Final line search alpha, max atom move = 1 1.10321e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12585    | 0.12585    | 0.12585    |   0.0 | 97.67
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0015264  | 0.0015264  | 0.0015264  |   0.0 |  1.18
Output  | 6.4135e-05 | 6.4135e-05 | 6.4135e-05 |   0.0 |  0.05
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001406   |            |       |  1.09

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316674342
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.50599078756656e-05
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.000113261934341762
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1.60590370984534e-05
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2.20231736163116e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 7.72565863089931e-11
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -7.96632156748081
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3.36795795981483e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.00113272718717406
variable C2pos equal ${d2}
variable C2pos equal -0.000160586621894082
variable C3pos equal ${d3}
variable C3pos equal -0.000220316156151789
variable C4pos equal ${d4}
variable C4pos equal -2.58165759249219e-08
variable C5pos equal ${d5}
variable C5pos equal 79.6632156616917
variable C6pos equal ${d6}
variable C6pos equal 3.23190052725955e-09

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-0.00113267851874371+${C1pos})
variable C15 equal 0.5*(-0.00113267851874371+0.00113272718717406)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(0.000160570857258442+${C2pos})
variable C25 equal 0.5*(0.000160570857258442+-0.000160586621894082)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(0.000220236196121464+${C3pos})
variable C35 equal 0.5*(0.000220236196121464+-0.000220316156151789)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(2.74132120419744e-08+${C4pos})
variable C45 equal 0.5*(2.74132120419744e-08+-2.58165759249219e-08)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(79.6632157494423+${C5pos})
variable C55 equal 0.5*(79.6632157494423+79.6632156616917)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.77260945253412e-09+${C6pos})
variable C65 equal 0.5*(-1.77260945253412e-09+3.23190052725955e-09)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.911311919073

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -1.0e-5*${len0}
variable delta equal -1.0e-5*14.911311919073
variable deltaxy equal -${up}*xy
variable deltaxy equal -1.0e-5*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -1.0e-5*xz
variable deltayz equal -${up}*yz
variable deltayz equal -1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.00014911311919073 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (-0.000149113 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332  0.014602529   0.68258447   0.70512148   -1.3438984    13.424667 -0.076359196   0.52920424    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.5059489e-05 -0.00011326404 2.2168558e-05 1.5917018e-05    7.9663216 8.0711673e-09 9.7171617e-10    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.136217 on 1 procs for 134 steps with 192 atoms

92.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316623     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.0094692 9.67562e-11
  Force max component initial, final = 0.00136894 1.11463e-11
  Final line search alpha, max atom move = 1 1.11463e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.13294    | 0.13294    | 0.13294    |   0.0 | 97.60
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0016663  | 0.0016663  | 0.0016663  |   0.0 |  1.22
Output  | 5.3883e-05 | 5.3883e-05 | 5.3883e-05 |   0.0 |  0.04
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001555   |            |       |  1.14

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.000113264044519576
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 2.21685583331027e-05
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1.59170181936058e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 7.96632157093869
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 8.07116725300342e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 9.71716174464224e-10

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.0011327482889522
variable C2neg equal ${d2}
variable C2neg equal 0.000221681834240575
variable C3neg equal ${d3}
variable C3neg equal 0.000159254601924731
variable C4neg equal ${d4}
variable C4neg equal 1.85415807141583e-09
variable C5neg equal ${d5}
variable C5neg equal 9.38281240722721e-08
variable C6neg equal ${d6}
variable C6neg equal 79.6632157053824

# Reset box and simulation parameters

clear
box tilt large
read_restart restart.equil
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  192 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# Choose potential
pair_style     rebo
pair_coeff     * * CH.airebo C
Reading potential file CH.airebo with DATE: 2011-10-25

#pair_style     lcbop
#pair_coeff     C.lcbop
#pair_style     tersoff
#pair_coeff     BNC.tersoff


# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup minimization style
min_style	     cg
min_modify	     dmax ${dmax} line quadratic
min_modify	     dmax 0.01 line quadratic

# Setup output
thermo		500
thermo_style custom step temp pe press pxx pyy pzz pxy pxz pyz lx ly lz vol
thermo_modify norm no


# Output
dump            1 all xtc 100 traj.xtc
dump            2 all xyz 2000 relaxed.xyz
#dump            4 all atom 10 dump.atom

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 1.0e-5*${len0}
variable delta equal 1.0e-5*14.911311919073
variable deltaxy equal ${up}*xy
variable deltaxy equal 1.0e-5*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1.0e-5*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1.0e-5*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.00014911311919073 remap units box
  triclinic box = (0.015844 0.00484404 0.017344) to (14.9272 14.9162 14.9287) with tilt (0.000149113 0 0)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 10000000 ${maxeval}
minimize 0 1e-10 10000000 10000000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair rebo, perpetual
      attributes: full, newton on, ghost
      pair build: full/nsq/ghost
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 4.912 | 4.912 | 4.912 Mbytes
Step Temp PotEng Press Pxx Pyy Pzz Pxy Pxz Pyz Lx Ly Lz Volume 
     297            0   -1397.6332  0.014608686   0.68264527   0.70509115   -1.3439104   -13.821336 -0.076378028   0.52922279    14.911312    14.911312    14.911312    3315.4888 
     431            0   -1397.6332 -2.5060088e-05 -0.00011326388 2.2171304e-05 1.5912315e-05   -7.9663216 7.775017e-09 7.5097694e-09    14.911312    14.911312    14.911312    3315.4888 
Loop time of 0.127828 on 1 procs for 134 steps with 192 atoms

96.0% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = force tolerance
  Energy initial, next-to-last, final = 
        -1397.63316623     -1397.63316674     -1397.63316674
  Force two-norm initial, final = 0.00946622 9.46502e-11
  Force max component initial, final = 0.00119766 1.16278e-11
  Final line search alpha, max atom move = 1 1.16278e-11
  Iterations, force evaluations = 134 268

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.12487    | 0.12487    | 0.12487    |   0.0 | 97.68
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0014446  | 0.0014446  | 0.0014446  |   0.0 |  1.13
Output  | 0.00011897 | 0.00011897 | 0.00011897 |   0.0 |  0.09
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001396   |            |       |  1.09

Nlocal:    192 ave 192 max 192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1344 ave 1344 max 1344 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  14880 ave 14880 max 14880 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14880
Ave neighs/atom = 77.5
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -1397.63316674342
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2.50600877833643e-05
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -0.000113263881744241
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 2.21713037317379e-05
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1.59123146624102e-05
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -7.96632156924269
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 7.77501700548561e-09
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 7.5097693924914e-09

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.00113274666119885
variable C2pos equal ${d2}
variable C2pos equal -0.000221709288226927
variable C3pos equal ${d3}
variable C3pos equal -0.000159207566612775
variable C4pos equal ${d4}
variable C4pos equal -6.72346902516876e-08
variable C5pos equal ${d5}
variable C5pos equal -9.0866621597094e-08
variable C6pos equal ${d6}
variable C6pos equal 79.6632156964314

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-0.0011327482889522+${C1pos})
variable C16 equal 0.5*(-0.0011327482889522+0.00113274666119885)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(0.000221681834240575+${C2pos})
variable C26 equal 0.5*(0.000221681834240575+-0.000221709288226927)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(0.000159254601924731+${C3pos})
variable C36 equal 0.5*(0.000159254601924731+-0.000159207566612775)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(1.85415807141583e-09+${C4pos})
variable C46 equal 0.5*(1.85415807141583e-09+-6.72346902516876e-08)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(9.38281240722721e-08+${C5pos})
variable C56 equal 0.5*(9.38281240722721e-08+-9.0866621597094e-08)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(79.6632157053824+${C6pos})
variable C66 equal 0.5*(79.6632157053824+79.6632156964314)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 147.289688030594
variable C22all equal ${C22}
variable C22all equal 147.289688030528
variable C33all equal ${C33}
variable C33all equal 147.289687964215

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(99.3740302611159+${C21})
variable C12all equal 0.5*(99.3740302611159+99.3740302669115)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(99.3740303132249+${C31})
variable C13all equal 0.5*(99.3740303132249+99.3740302904725)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(99.3740302962227+${C32})
variable C23all equal 0.5*(99.3740302962227+99.3740302939023)

variable C44all equal ${C44}
variable C44all equal 79.6632156868451
variable C55all equal ${C55}
variable C55all equal 79.663215705567
variable C66all equal ${C66}
variable C66all equal 79.6632157009069

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(3.19971028299904e-09+${C41})
variable C14all equal 0.5*(3.19971028299904e-09+4.51768374351795e-08)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(2.43342151750106e-08+${C51})
variable C15all equal 0.5*(2.43342151750106e-08+4.71674313893215e-08)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-8.13876675038669e-10+${C61})
variable C16all equal 0.5*(-8.13876675038669e-10+-5.518876977593e-08)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(1.03480905299736e-08+${C42})
variable C24all equal 0.5*(1.03480905299736e-08+6.4151608620927e-08)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-7.88231781999023e-09+${C52})
variable C25all equal 0.5*(-7.88231781999023e-09+-5.4549327462086e-09)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-1.37269931760011e-08+${C62})
variable C26all equal 0.5*(-1.37269931760011e-08+5.79892995053751e-09)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(1.26751769435012e-08+${C43})
variable C34all equal 0.5*(1.26751769435012e-08+2.5672318888606e-08)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-3.99800151625046e-08+${C53})
variable C35all equal 0.5*(-3.99800151625046e-08+-1.19749753944435e-08)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(2.35176559780021e-08+${C63})
variable C36all equal 0.5*(2.35176559780021e-08+-3.8349029183326e-08)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(7.9831805852625e-10+${C54})
variable C45all equal 0.5*(7.9831805852625e-10+1.41186411479685e-08)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.26902660901359e-08+${C64})
variable C46all equal 0.5*(-3.26902660901359e-08+-1.7165984274601e-08)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(1.48075123758905e-09+${C65})
variable C56all equal 0.5*(1.48075123758905e-09+7.29645537362715e-10)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (147.289688030594+${C22all}+${C33all})/3.0
variable C11cubic equal (147.289688030594+147.289688030528+${C33all})/3.0
variable C11cubic equal (147.289688030594+147.289688030528+147.289687964215)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (99.3740302640137+${C13all}+${C23all})/3.0
variable C12cubic equal (99.3740302640137+99.3740303018487+${C23all})/3.0
variable C12cubic equal (99.3740302640137+99.3740303018487+99.3740302950625)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (79.6632156868451+${C55all}+${C66all})/3.0
variable C44cubic equal (79.6632156868451+79.663215705567+${C66all})/3.0
variable C44cubic equal (79.6632156868451+79.663215705567+79.6632157009069)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (147.289688008446+2*${C12cubic})/3.0
variable bulkmodulus equal (147.289688008446+2*99.374030286975)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 79.663215697773
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (147.289688008446-${C12cubic})/2.0
variable shearmodulus2 equal (147.289688008446-99.374030286975)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+147.289688008446/${C12cubic})
variable poissonratio equal 1.0/(1.0+147.289688008446/99.374030286975)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 147.289688030594 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 147.289688030528 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 147.289687964215 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 99.3740302640137 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 99.3740303018487 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 99.3740302950625 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 79.6632156868451 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 79.663215705567 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 79.6632157009069 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = 2.41882738590893e-08 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = 3.57508232821661e-08 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -2.80013232254843e-08 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = 3.72498495754503e-08 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -6.66862528309942e-09 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -3.9640316127318e-09 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 1.91737479160536e-08 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = -2.5977495278474e-08 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -7.41568660266195e-09 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = 7.45847960324738e-09 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = -2.49281251823685e-08 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 1.10519838747588e-09 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 115.345916194132 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 79.663215697773 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 23.9578288607355 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.402872505829812
print "Deformation size: ${up}"
Deformation size: 1.0e-5

print "Lattice_type	lattice_constant	bulk_modulus	poisson	     c11	     c12         c44	" file elastic_constants.out
Lattice_type	lattice_constant	bulk_modulus	poisson	     c11	     c12         c44	
print "${lattype}    ${latconst}    ${bulkmodulus}     ${poissonratio}     ${C11all}     ${C12all}     ${C44all}" append elastic_constants.out
sc    14.9    115.345916194132     0.402872505829812     147.289688030594     99.3740302640137     79.6632156868451
Total wall time: 0:00:02
